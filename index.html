<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>Gá»­i Äá»‹nh Vá»‹ TrÆ°á»›c Khi LÃ m BÃ i</title>
<style>
body { font-family: Arial, sans-serif; text-align: center; margin-top: 40px; }
#status { color: green; margin-bottom: 10px; }
</style>
</head>
<body>
<h2>ğŸ“ Vui lÃ²ng cho phÃ©p Ä‘á»‹nh vá»‹ Ä‘á»ƒ tiáº¿p tá»¥c lÃ m bÃ i</h2>
<div id="status">â³ Äang láº¥y vá»‹ trÃ­...</div>

<script>
// MÃ£ entry cho cÃ¡c cÃ¢u há»i trong Google Form
const gpsField = "entry.1014854034";
const addressField = "entry.675148276";

// URL cá»§a Google Form
const formUrl = "https://docs.google.com/forms/d/e/1FAIpQLSeDxjzSU5rjlQiR9z_8LQUEcJc7cSg3mQvQkzSikIzxaf1phw/formResponse";

// Chá»©c nÄƒng gá»­i thÃ´ng tin Ä‘á»‹nh vá»‹ vÃ o Google Form
function sendToGoogleForm(lat, lon, address) {
const params = new URLSearchParams();
params.append(gpsField, `${lat}, ${lon}`);
params.append(addressField, address);

fetch(formUrl, {
method: "POST",
mode: "no-cors",
body: params
}).then(() => {
document.getElementById("status").innerText = "âœ… Äá»‹nh vá»‹ Ä‘Ã£ gá»­i thÃ nh cÃ´ng! Báº¡n cÃ³ thá»ƒ tiáº¿p tá»¥c lÃ m bÃ i.";
// Sau khi gá»­i Ä‘á»‹nh vá»‹, sinh viÃªn sáº½ Ä‘Æ°á»£c chuyá»ƒn Ä‘áº¿n Google Form Ä‘á»ƒ lÃ m bÃ i
setTimeout(() => {
window.location.href = "https://docs.google.com/forms/d/e/1FAIpQLSeDxjzSU5rjlQiR9z_8LQUEcJc7cSg3mQvQkzSikIzxaf1phw/viewform";
}, 2000);
}).catch(() => {
document.getElementById("status").innerText = "âŒ Gá»­i Ä‘á»‹nh vá»‹ tháº¥t báº¡i. Vui lÃ²ng thá»­ láº¡i.";
});
}

// Chá»©c nÄƒng láº¥y vá»‹ trÃ­ tá»« trÃ¬nh duyá»‡t
function getLocation() {
if (!navigator.geolocation) {
document.getElementById("status").innerText = "âš ï¸ TrÃ¬nh duyá»‡t khÃ´ng há»— trá»£ Ä‘á»‹nh vá»‹.";
return;
}

navigator.geolocation.getCurrentPosition(
position => {
const lat = position.coords.latitude;
const lon = position.coords.longitude;

// Láº¥y tÃªn Ä‘á»‹a chá»‰ tá»« OpenStreetMap
fetch(`https://nominatim.openstreetmap.org/reverse?lat=${lat}&lon=${lon}&format=json`)
.then(res => res.json())
.then(data => {
const address = data.display_name || "KhÃ´ng rÃµ Ä‘á»‹a chá»‰";
sendToGoogleForm(lat, lon, address);
})
.catch(() => sendToGoogleForm(lat, lon, "KhÃ´ng rÃµ Ä‘á»‹a chá»‰"));
},
() => {
document.getElementById("status").innerText = "âŒ Vui lÃ²ng cho phÃ©p truy cáº­p vá»‹ trÃ­.";
}
);
}

window.onload = () => {
setTimeout(getLocation, 1000);
};
</script>
</body>
</html>
